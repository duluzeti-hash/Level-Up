<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Monitoramento do Jogo INDO</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<link rel="stylesheet" href="style.css">
<style>
    /* Estilos base que você forneceu, com alguns ajustes */
    body { font-family: Arial, sans-serif; background: #f0f0f0; padding: 20px; color: #333; }
    h1 { color: #ffcc00; /* Cor do logo INDO */ text-align: center; text-shadow: 1px 1px 2px #555; }
    h2 { margin-top: 10px; border-bottom: 2px solid #ffcc00; padding-bottom: 5px; }
    ul { list-style: none; padding-left: 0; }
    li { background: #fff; margin: 5px 0; padding: 8px; border-radius: 5px; }
    
    .container { display: flex; gap: 20px; flex-wrap: wrap; }
    .box { background: #fff; padding: 15px; border-radius: 8px; flex: 1; min-width: 280px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }

    /* Estilo para o Status do Jogo (NOVO) */
    #status-jogo { font-size: 1.2em; font-weight: bold; color: #007bff; }
    #cronometro { font-size: 1.5em; font-weight: bold; color: #d9534f; }
    
    /* Estilo para o Log de Eventos (NOVO) */
    #lista-log {
        max-height: 200px;
        overflow-y: auto; /* Adiciona scroll se o log ficar grande */
        font-size: 0.9em;
        color: #555;
    }
    #lista-log li { background: #f9f9f9; padding: 5px; }
</style>
</head>
<body>

  <h1>Monitoramento em Tempo Real - Jogo INDO</h1>

  <div class="container">

    <div class="box" id="status-geral">
        <h2>Status do Jogo</h2>
        <p><strong id="status-jogo">Aguardando início...</strong></p>
    </div>

    <div class="box" id="rodada-atual">
      <h2>Rodada Atual</h2>
      <p><strong>Número:</strong> <span id="numero-rodada">0</span></p>
      <p><strong>Tema:</strong> <span id="tema-rodada">Aguardando...</span></p>
            <p><strong>Jogador da Vez:</strong> <span id="jogador-da-vez">Ninguém</span></p>
      <p><strong>Tempo Restante:</strong> <span id="cronometro">--:--</span></p>
    </div>

    <div class="box" id="pontuacao">
      <h2>Pontuação</h2>
      <ul id="placar">
          </ul>
    </div>

    <div class="box" id="status-jogadores">
      <h2>Jogadores Conectados</h2>
      <ul id="lista-jogadores"></ul>
    </div>

    <div class="box" id="dicas">
      <h2>Dicas da Rodada</h2>
      <ul id="lista-dicas"></ul>
    </div>

    <div class="box" id="log-eventos">
      <h2>Log de Eventos</h2>
      <ul id="lista-log">
          </ul>
    </div>
  </div>

  <script>
    // Conecta ao servidor (mesmo endereço do jogo)
    const socket = io();

    // Seletores (buscando uma vez para melhor performance)
    const elListaJogadores = document.getElementById("lista-jogadores");
    const elNumeroRodada = document.getElementById("numero-rodada");
    const elTemaRodada = document.getElementById("tema-rodada");
    const elPlacar = document.getElementById("placar");
    const elListaDicas = document.getElementById("lista-dicas");
    
    // Novos seletores
    const elStatusJogo = document.getElementById("status-jogo");
    const elJogadorDaVez = document.getElementById("jogador-da-vez");
    const elCronometro = document.getElementById("cronometro");
    const elListaLog = document.getElementById("lista-log");

    // --- Listeners do Socket ---

    // SUGESTÃO: Modifiquei para incluir a equipe do jogador
    socket.on("atualiza-jogadores", (jogadores) => {
      elListaJogadores.innerHTML = "";
      jogadores.forEach(j => {
        const li = document.createElement("li");
        // Ex: "Duzão (Equipe 1) - Conectado"
        li.textContent = `${j.nome} (Equipe ${j.equipe}) ${j.conectado ? "- Conectado" : "- Offline"}`;
        elListaJogadores.appendChild(li);
      });
    });

    socket.on("atualiza-rodada", (rodada) => {
      elNumeroRodada.textContent = rodada.numero;
      elTemaRodada.textContent = rodada.tema;
      // Limpa as dicas da rodada anterior
      elListaDicas.innerHTML = ""; 
    });

    socket.on("atualiza-pontuacao", (pontos) => {
      elPlacar.innerHTML = "";
      // Assumindo que 'pontos' é um objeto como { equipe1: 10, equipe2: 5 }
      // Se for uma lista (como no seu original), mantenha o seu .forEach
      for (const equipe in pontos) {
        const li = document.createElement("li");
        li.textContent = `Equipe ${equipe}: ${pontos[equipe]} pts`;
        elPlacar.appendChild(li);
      }
    });

    // Modificado para 'nova-dica' para adicionar uma por vez
    socket.on("nova-dica", (dica) => {
      const li = document.createElement("li");
      li.textContent = `${dica.jogador}: ${dica.texto}`;
      // Adiciona a dica no topo da lista
      elListaDicas.prepend(li);
    });

    // --- Novos Listeners Essenciais ---

    /**
     * Atualiza o status principal do jogo
     * (Ex: "Aguardando Jogadores", "Rodada 1 em Andamento", "Fim de Jogo")
     */
    socket.on("atualiza-status-jogo", (statusTexto) => {
        elStatusJogo.textContent = statusTexto;
    });

    /**
     * Atualiza o cronômetro em tempo real
     * (Recebe o tempo formatado, ex: "00:45")
     */
    socket.on("atualiza-cronometro", (tempo) => {
        elCronometro.textContent = tempo;
    });

    /**
     * Destaca o jogador que está dando a dica
     */
    socket.on("atualiza-jogador-da-vez", (jogadorNome) => {
        elJogadorDaVez.textContent = jogadorNome;
    });

    /**
     * Adiciona um evento ao Log
     * (Ex: "Equipe 1 acertou a palavra 'Casa'", "Tempo esgotado para Duzão")
     */
    socket.on("log-evento", (mensagem) => {
        const li = document.createElement("li");
        li.textContent = `[${new Date().toLocaleTimeString()}]: ${mensagem}`;
        // Adiciona no topo e rola para o início
        elListaLog.prepend(li); 
    });

  </script>
</body>
</html>